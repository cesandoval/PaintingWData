doctype html
html
  head
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-118514810-1"></script>
    script.
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-118514810-1');

    meta(charset="utf-8")
    meta(http-equiv="X-UA-Compatible", content="IE=edge")
    title= 'Painting with Data'

    //indicate that our site is mobile optimized
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    meta(name="description", content="")
    meta(name="author", content="")
    link(rel="icon", href="/images/pwd_logo.png")
    link(rel='stylesheet', href='/stylesheets/w3.css')
    style
      body { margin:0; padding:0; }
      .map { position:absolute; top:0; bottom:0; width:100%; }

    link(rel='apple-touch-icon', sizes='180x180', href='/apple-touch-icon.png')
    link(rel='icon', type='image/png', sizes='32x32', href='/favicon-32x32.png')
    link(rel='icon', type='image/png', sizes='16x16', href='/favicon-16x16.png')
    link(rel='manifest', href='/manifest.json')
    link(rel='mask-icon', href='/safari-pinned-tab.svg', color='#5bbad5')
    meta(name='theme-color', content='#ffffff')

    //- //add bootstrap dependencies from CDNjs. Using a CDN to distribute these files puts less pressure
    //- //on our web server and will be delivered faster to the client than our own server.
    //- script(src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js')		

    
    script(src='/javascripts/js/jquery-1.9.1.js')
    script(src="/javascripts/js/jquery-ui.js")
    script(type='text/javascript', src="/javascripts/js/tether.min.js")
    link(href='/stylesheets/mapbox.css', rel='stylesheet')

    link(rel='stylesheet', href='/stylesheets/bootstrap-theme.min.css')
    link(rel='stylesheet', href='/stylesheets/font-awesome.min.css')
    //- //reference our site-specific css
    link(rel='stylesheet', href='/stylesheets/bootstrap.min.css')
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/stylesheets/vprog.css')
    link(rel='stylesheet', href='/stylesheets/awesome-bootstrap-checkbox.css')
    link(rel='stylesheet', href='/stylesheets/build.css')
    link(rel='stylesheet', href='/stylesheets/login.css')




    //- // Mapbox Libraries
    script(src='/javascripts/js/mapbox.js')

    //- // D3 libs
    script(type='text/javascript', src="/javascripts/js/d3.js")
    
    //- // Parallel Coords UI libs
    script(type='text/javascript', src="/javascripts/js/d3.parcoords.js")
    link(rel="stylesheet", type="text/css", href="/stylesheets/d3.parcoords.css")
    
    //- // THREEjs libs
    script(type='text/javascript', src="/javascripts/js/three.js")
    script(type='text/javascript', src="/javascripts/js/THREEx.KeyboardState.js")
    //- script(type='text/javascript', src="/javascripts/js/THREEx.FullScreen.js")
    script(type='text/javascript', src="/javascripts/js/THREEx.WindowResize.js")


    // PaintingWithData CSS
    link(rel='stylesheet', href='/stylesheets/base.css')

    // Bootstrap JS libs
    script(type='text/javascript', src="/javascripts/js/bootstrap.min.js")    

  body
    block navBar
      include ./partials/navbarSidePage

    block pageTitle
    block content

    div.footer
      div.row.home_icon_row
        div.home_icon_wrapper
            a(href='https://twitter.com/PaintingWData', target='_blank')
                img.icon_link_img.mybtn.home_icon(src='/images/twitter.png')
        div.home_icon_wrapper
            a(href='https://www.facebook.com/PaintingWData/', target='_blank')
                img.icon_link_img.mybtn.home_icon(src='/images/facebook.png')
        div.home_icon_wrapper
            a(href='https://www.linkedin.com/company/27180309/', target='_blank')
                img.icon_link_img.mybtn.home_icon(src='/images/linkedin.png')
      div.contact-div.
        Have a quick question? Email our Support Team at support@paintingwithdata.com
      div.terms-bar
        span.terms(id="show-policy")
            b privacy policy
        &nbsp;&nbsp;|&nbsp;&nbsp;
        span.terms(id="show-terms")
            b terms and conditions

      p &copy; Painting with Data 2018. 
        span.
            Patent Pending.

script.
  $('.dropdown').on('show.bs.dropdown', function() {
    $(this).find('.dropdown-menu').first().stop(true, true).slideDown();
  });

  $('.dropdown').on('hide.bs.dropdown', function() {
    $(this).find('.dropdown-menu').first().stop(true, true).slideUp();
  });

  jQuery('ul.nav li.dropdown').hover(function() {
    jQuery(this).find('.dropdown-menu').first().stop(true, true).slideDown();
    }, function() {
      jQuery(this).find('.dropdown-menu').first().stop(true, true).slideUp();
      });

   $(document).ready(function() {
    var height = $(".navbar").height();
    //- $(".dropdown-menu").top(height);
  });

script.
  d3.selectAll(".tm_wrapper .icon_over").on("mouseover", function () {
    d3.select(this).style("opacity", 0.6);
  }).on("mouseout", function () {
    d3.select(this).style("opacity", 0);
  });

  $("#explore").click(() => {
    $('html, body').animate({
        scrollTop: $("#app").offset().top-80
    }, 2000);
  });
  $("#about").click(() => {
    $('html, body').animate({
        scrollTop: $("#about_section").offset().top-80
    }, 2000);
  });
  $("#team").click(() => {
    $('html, body').animate({
        scrollTop: $("#team_section").offset().top-80
    }, 2000);
  });



  $(".pop_team").click(function () {

      d3.select("body").append("div")
          .attr("class", "pop_team_box_back").style("top", $(document).scrollTop() + "px")
          ;

      var thisholder = d3.select("body").append("div")
          .attr("class", "pop_team_box").style("top", $(document).scrollTop() + window.innerHeight * 0.2 + "px");

      thisholder
          .append("img").attr("src", "images/thex.png").attr("class", "close_expanded");

      var left_panel = thisholder.append("div").attr("class","col-sm-5 box_column");
      var right_panel = thisholder.append("div").attr("class","col-sm-7 box_column left_mark");

      left_panel.append("img").attr("class","member_box_img").attr("src",$(this).attr("img_url"));
      left_panel.append("p").attr("class","member_box_title").text($(this).attr("name"));
      left_panel.append("p").attr("class","member_box_email").text($(this).attr("email"));

      var r1_1_0 = left_panel.append("div").attr("class", "icon_links_box");

      if ($(this).attr("home_url")) {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<a href="' + $(this).attr("home_url") + '" target="_blank"><img src="images/homepage.png" class="icon_link_img mybtn"></a>');
      }

      else {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<img src="images/homepage.png" class="icon_link_img mybtn">');
      }

      if ($(this).attr("twitter_url")) {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<a href="' + $(this).attr("twitter_url") + '" target="_blank"><img src="images/twitter.png" class="icon_link_img mybtn"></a>');
      }
      else {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<img src="images/twitter.png" class="icon_link_img mybtn">');
      }

      if ($(this).attr("linkedin_url")) {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<a href="' + $(this).attr("linkedin_url") + '" target="_blank"><img src="images/linkedin.png" class="icon_link_img mybtn"></a>');
      } else {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<img src="images/linkedin.png" class="icon_link_img mybtn">');
      }

      if ($(this).attr("github_url")) {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<a href="' + $(this).attr("github_url") + '" target="_blank"><img src="images/github.png" class="icon_link_img mybtn"></a>');
      } else {
          r1_1_0.append("div")
              .attr("class", "icon_25")
              .attr("style", "padding:0px;")
              .html('<img src="images/github.png" class="icon_link_img mybtn">');
      }

      right_panel.append("p").attr("class","member_box_bio").text($(this).attr("bio1"));
      if($(this).attr("bio2")){
          right_panel.append("p").attr("class","member_box_bio").text($(this).attr("bio2"));
      }
      if($(this).attr("bio3")){
          right_panel.append("p").attr("class","member_box_bio").text($(this).attr("bio3"));
      }

      $(".pop_team_box .close_expanded").click(function () {
          d3.selectAll(".pop_team_box").remove();
          d3.selectAll(".pop_team_box_back").remove();
      });

      $(".pop_team_box_back").click(function () {
          d3.selectAll(".pop_team_box").remove();
          d3.selectAll(".pop_team_box_back").remove();
      });
      
  });


script(src="/javascripts/progressWidget.js", type="text/javascript")

script.
  $("#agreement").click(function(){
    d3.selectAll(".signup-btn").classed("hidden-btn",!d3.select(this).property("checked"));
  })
    d3.selectAll("#show-terms").on("click",function(){
        d3.select(".surveyBack").remove();
        d3.select(".surveyBox").remove();

        let surveyBack = d3.select("body").append("div").classed("surveyBack",true).on("click",function(){
            d3.select(".surveyBack").remove();
            d3.select(".surveyBox").remove();
        });
        let surveyBox = d3.select("body").append("div").classed("surveyBox",true);
        surveyBox.append("p").classed("delete_surveybox",true).text("X").on("click",function(){
            d3.select(".surveyBack").remove();
            d3.select(".surveyBox").remove();
        });
        let embeddingBox = surveyBox.append("div").classed("embedding-box",true);
        embeddingBox.append("iframe").attr("src","/posts/terms/CopyofPaintingwithDataTermsofServiceDraft.html").classed("embedded",true)
    })

    d3.selectAll("#show-policy").on("click",function(){
        console.log("yyy");
        d3.select(".surveyBack").remove();
        d3.select(".surveyBox").remove();

        let surveyBack = d3.select("body").append("div").classed("surveyBack",true).on("click",function(){
            d3.select(".surveyBack").remove();
            d3.select(".surveyBox").remove();
        });
        let surveyBox = d3.select("body").append("div").classed("surveyBox",true);
        surveyBox.append("p").classed("delete_surveybox",true).text("X").on("click",function(){
            d3.select(".surveyBack").remove();
            d3.select(".surveyBox").remove();
        });
        let embeddingBox = surveyBox.append("div").classed("embedding-box",true);
        embeddingBox.append("iframe").attr("src","/posts/terms/CopyofPaintingwithDataPrivacyPolicyDraft.html").classed("embedded",true)
    })


  $("#trigger_survey").click(function(){
      d3.select(".surveyBack").remove();
      d3.select(".surveyBox").remove();

      let surveyBack = d3.select("body").append("div").classed("surveyBack",true).on("click",function(){
        d3.select(".surveyBack").remove();
        d3.select(".surveyBox").remove();
      });
      let surveyBox = d3.select("#signup_form").append("div").classed("surveyBox",true);
      surveyBox.append("p").classed("delete_surveybox",true).text("X").on("click",function(){
        d3.select(".surveyBack").remove();
        d3.select(".surveyBox").remove();
      });

      surveyBox.append("p").classed("survey_title",true).text("Tell us more about you!");
      let surveySubBox = surveyBox.append("div").classed("surveySubBox",true);

      let survey_use = surveySubBox.append("div").classed("survey_use",true).classed("survey_item",true);
      survey_use.append("p").classed("survey_subtitle",true).text("What will you use the application for?");
      let use_options = survey_use.append("select").attr("id","use").attr("name","use");
      use_options.append("option").attr("value", "").text("--");
      use_options.append("option").attr("value", "Communication").text("Communication");
      use_options.append("option").attr("value", "Data Visualization").text("Data Visualization");
      use_options.append("option").attr("value", "Educational").text("Educational");
      use_options.append("option").attr("value", "Real Estate Development").text("Real Estate Development");
      use_options.append("option").attr("value", "Spatial Analysis").text("Spatial Analysis");
      use_options.append("option").attr("value", "Others").text("Others");

      let survey_industry = surveySubBox.append("div").classed("survey_industry",true).classed("survey_item",true);
      survey_industry.append("p").classed("survey_subtitle",true).text("What industry are you in?");
      let industry_options = survey_industry.append("select").attr("id","industry").attr("name","industry");
      industry_options.append("option").attr("value", "").text("--");
      industry_options.append("option").attr("value", "Design").text("Design");
      industry_options.append("option").attr("value", "Geography").text("Geography");
      industry_options.append("option").attr("value", "Journalism").text("Journalism");
      industry_options.append("option").attr("value", "Landscape Architecture").text("Landscape Architecture");
      industry_options.append("option").attr("value", "Policy Making").text("Policy Making");
      industry_options.append("option").attr("value", "Public Health").text("Public Health");
      industry_options.append("option").attr("value", "Real Estate").text("Real Estate");
      industry_options.append("option").attr("value", "Urban Planning").text("Urban Planning");
      industry_options.append("option").attr("value", "Others").text("Others");

      let survey_referal = surveySubBox.append("div").classed("survey_referal",true).classed("survey_item",true);
      survey_referal.append("p").classed("survey_subtitle",true).text("How did you hear about us?");
      let referal_options = survey_referal.append("select").attr("id","referal").attr("name","referal");
      referal_options.append("option").attr("value", "").text("--");
      referal_options.append("option").attr("value", "Event").text("Event");
      referal_options.append("option").attr("value", "Friend Recommendation").text("Friend Recommendation");
      referal_options.append("option").attr("value", "Social Media").text("Social Media");
      referal_options.append("option").attr("value", "Search Engine").text("Search Engine");
      referal_options.append("option").attr("value", "Workshop").text("Workshop");
      referal_options.append("option").attr("value", "Others").text("Others");

      let survey_submit = surveySubBox.append("input").attr("type","submit").classed("survey_submit",true).attr("value","Done!")
                            .attr("data-transition","fade")
                            .attr("data-theme","c")

    //- input(type='submit',value='Sign Up',data-transition='fade', data-theme='c', class="btn btn-outline-primary")

    //- input(type="text", id="email", class="form-control form-input-line", name="username", placeholder="newuser@gmail.com")



    


  });


    var fixiframe = function(myid){
        $(myid).contents().find("head")
            .append($("<style type='text/css'>  *{background-color:rgba(0,0,0,0)!important; overflow:hidden;}  .content_left{width:65%;float:left;} .content_right{width:33%;float:left;} .content_right_full{width:100%;float:right;}</style>"));
        $(myid).contents().find("a")
            .attr("target","_blank")
            .attr("href", function(d,dd){
                if(dd){
                    var out = dd;
                    if(out.indexOf("?q=")>-1)
                        out = dd.split("?q=")[1];
                    if(out.indexOf("&sa=D&ust=")>-1)
                    out = out.split("&sa=D&ust=")[0];
                    return out;
                }
            })
            ;
        $(myid).contents().find("img")
            .css("width","100%").css("height","auto");
        $(myid).contents().find("span")
            .css("width","100%").css("height","auto");
        $(myid).contents().find("body")
            .css("padding","0 0 0 0");



        $(myid).contents().find("span")
            .filter(function(){
                return this.innerHTML.indexOf("&lt;iframe")!=-1;
            }).html(function(){
                return this.innerHTML.replace("&lt;","<").replace("&gt;",">");
            });
        $(myid).contents().find("td")
            .filter(function(){
                if($(this).attr("colspan") == "1" && $(this).attr("rowspan") == "1"){
                    var widththis = +d3.select(this).style("width").split("px")[0];

                    if(this.innerHTML.indexOf("Overview")!=-1){
                        $(this).replaceWith( "<div class = 'content_right_full left_proj'>"+$(this).html()+"</div>"
                        );
                    }else{
                        $(this).replaceWith( "<div class = 'content_right_full right_proj' style = 'display:none;'>"+$(this).html()+"</div>"
                        );
                    }

                    //- if($(document).width()<500){
                    //-     if(this.innerHTML.indexOf("Overview")!=-1){
                    //-         $(this).replaceWith( "<div class = 'content_right_full left_proj'>"+$(this).html()+"</div>"
                    //-         );
                    //-     }else{
                    //-         $(this).replaceWith( "<div class = 'content_right_full right_proj'>"+$(this).html()+"</div>"
                    //-         );
                    //-     }

                    //- }
                    
                    //- else{
                    //-     if(this.innerHTML.indexOf("Overview")!=-1){
                    //-         $(this).replaceWith( "<div class = 'content_left'>"+$(this).html()+"</div>"
                    //-         );
                    //-     }else{
                    //-         $(this).replaceWith( "<div class = 'content_right'>"+$(this).html()+"</div>"
                    //-         );
                    //-     }
                    //- }

                    return true;
                }
            });
            
            $(myid).contents().find("div")
            .filter(function(){
                if($(this).attr("class"))
                return $(this).attr("class").indexOf("left_proj")>-1;
            }).insertAfter(
                $(myid).contents().find("div")
                .filter(function(){
                    if($(this).attr("class"))
                    return $(this).attr("class").indexOf("right_proj")>-1;
                })
            )
    };

    var expand_function = function(myid){
        var iFrame = document.getElementById( myid );
        this.resizeIFrameToFitContent( iFrame );
        iFrame.parentElement.style.height = $("#"+myid).height()+20 + "px";
    }

    var resizeIFrameToFitContent = function( obj ) {
        if(obj)
        obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
    };

    var getVidemThumb = (thumb_wrapper) => {
        let video_id = thumb_wrapper.attr("id");

        $.ajax({
            type:'GET',
            url: 'https://vimeo.com/api/v2/video/' + video_id + '.json',
            jsonp: 'callback',
            dataType: 'jsonp',
            success: function(data){
                var thumbnail_src = data[0].thumbnail_large;
                thumb_wrapper.append("img").attr("src",thumbnail_src);
            }
        });




    }

        if (window.location.href.indexOf("tutorials")!==-1){
            // parse video posts' thumbnail
            d3.selectAll(".blog-img-wrapper")[0].forEach((item) => {
                let thiswrapper = d3.select(item);

                // video post
                if(thiswrapper.attr("id")){
                    getVidemThumb(thiswrapper);

                }
            });
        }
